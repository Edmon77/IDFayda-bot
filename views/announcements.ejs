<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Announcements ‚Äî Fayda Bot</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg: #0f0f12;
            --surface: #18181c;
            --surface2: #1f1f24;
            --text: #e4e4e7;
            --muted: #a1a1aa;
            --accent: #6366f1;
            --accent-hover: #818cf8;
            --danger: #ef4444;
            --radius: 12px;
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
            line-height: 1.5;
        }

        .header {
            background: var(--surface);
            border-bottom: 1px solid rgba(255, 255, 255, 0.06);
            padding: 1rem 1.5rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .header h1 {
            font-size: 1.25rem;
            font-weight: 600;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem 1.5rem;
        }

        .card {
            background: var(--surface);
            border: 1px solid rgba(255, 255, 255, 0.06);
            border-radius: var(--radius);
            padding: 2rem;
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
        }

        .title-group {
            margin-bottom: 1.5rem;
        }

        .title-group h2 {
            font-size: 1.1rem;
            margin-bottom: 0.25rem;
        }

        .title-group p {
            font-size: 0.85rem;
            color: var(--muted);
        }

        .presets {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 0.75rem;
            margin-bottom: 2rem;
        }

        .preset-btn {
            background: var(--surface2);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 8px;
            padding: 1rem;
            color: var(--text);
            text-align: left;
            cursor: pointer;
            transition: all 0.2s;
        }

        .preset-btn:hover {
            border-color: var(--accent);
            transform: translateY(-2px);
            background: rgba(99, 102, 241, 0.05);
        }

        .preset-btn b {
            display: block;
            font-size: 0.85rem;
            margin-bottom: 0.25rem;
            color: var(--accent);
        }

        .preset-btn span {
            font-size: 0.75rem;
            color: var(--muted);
            display: block;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        label {
            display: block;
            font-size: 0.8rem;
            color: var(--muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 0.5rem;
        }

        textarea {
            width: 100%;
            height: 250px;
            background: var(--surface2);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 1rem;
            color: var(--text);
            font-family: inherit;
            font-size: 0.95rem;
            resize: vertical;
            transition: border-color 0.2s;
        }

        textarea:focus {
            outline: none;
            border-color: var(--accent);
        }

        .stats-info {
            background: rgba(99, 102, 241, 0.1);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 0.9rem;
            color: var(--accent-hover);
        }

        .actions {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-family: inherit;
        }

        .btn-primary {
            background: var(--accent);
            color: white;
        }

        .btn-primary:hover {
            background: var(--accent-hover);
            transform: translateY(-1px);
        }

        .btn-ghost {
            background: transparent;
            color: var(--muted);
            text-decoration: none;
        }

        .btn-ghost:hover {
            color: var(--text);
            background: rgba(255, 255, 255, 0.05);
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(4px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 1.5rem;
        }

        .modal {
            background: var(--surface);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius);
            padding: 2rem;
            max-width: 500px;
            width: 100%;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
        }

        .modal h2 {
            margin-bottom: 1rem;
            font-size: 1.25rem;
        }

        .modal p {
            color: var(--muted);
            font-size: 0.9rem;
            margin-bottom: 1.5rem;
            line-height: 1.6;
        }

        .modal-actions {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
        }

        .feedback {
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1.5rem;
            font-size: 0.9rem;
            display: none;
        }

        .feedback.success {
            background: rgba(34, 197, 94, 0.1);
            color: #4ade80;
            display: block;
        }

        .feedback.error {
            background: rgba(239, 68, 68, 0.1);
            color: #f87171;
            display: block;
        }

        @media (max-width: 600px) {
            .presets {
                grid-template-columns: 1fr;
            }

            .card {
                padding: 1.25rem;
            }
        }
    </style>
</head>

<body>
    <header class="header">
        <h1>Fayda Bot <span
                style="font-size: 0.9rem; font-weight: 400; color: var(--muted); margin-left: 0.5rem;">Announcements</span>
        </h1>
        <a href="/dashboard" class="btn btn-ghost">‚Üê Back to Dashboard</a>
    </header>

    <main class="container">
        <% if (locals.success) { %>
            <div class="feedback success">‚úÖ <%= success %>
            </div>
            <% } %>
                <% if (locals.error) { %>
                    <div class="feedback error">‚ùå <%= error %>
                    </div>
                    <% } %>

                        <div class="card">
                            <div class="title-group">
                                <h2>üì¢ Broadcast Message</h2>
                                <p>Deliver an announcement to every single user of the bot (approx. <%= userCount %>
                                        recipients).</p>
                            </div>

                            <div class="stats-info">
                                <span>‚ÑπÔ∏è</span>
                                <span>Messages are sent in parallel with rate-limiting (10/sec) to ensure stability and
                                    avoid Telegram blocks.</span>
                            </div>

                            <label>Choose a Preset Template</label>
                            <div class="presets">
                                <button class="preset-btn" onclick="applyPreset('maintenance')">
                                    <b>üõ† System Maintenance</b>
                                    <span>Notify users about upcoming downtime.</span>
                                </button>
                                <button class="preset-btn" onclick="applyPreset('restored')">
                                    <b>‚ú® Service Restored</b>
                                    <span>Let users know they can now resume.</span>
                                </button>
                                <button class="preset-btn" onclick="applyPreset('newfeature')">
                                    <b>üöÄ New Feature</b>
                                    <span>Announce an exciting update or bot addition.</span>
                                </button>
                                <button class="preset-btn" onclick="applyPreset('clear')">
                                    <b>üßπ Clear Box</b>
                                    <span>Start writing a fresh custom message.</span>
                                </button>
                            </div>

                            <form id="announcementForm" method="POST" action="/announcements/send">
                                <div class="form-group">
                                    <label for="message">Your Message (Markdown Supported)</label>
                                    <textarea id="message" name="message"
                                        placeholder="Type your announcement here... Use dual languages for better reach."
                                        required></textarea>
                                </div>

                                <div class="actions">
                                    <button type="button" class="btn btn-primary" onclick="showConfirm()">üöÄ Send to All
                                        Users</button>
                                </div>
                            </form>
                        </div>
    </main>

    <div class="modal-overlay" id="confirmModal">
        <div class="modal">
            <h2>Confirm Broadcast?</h2>
            <p>You are about to send this announcement to **<%= userCount %> users**. This action cannot be undone. Are
                    you sure you want to proceed?</p>
            <div class="modal-actions">
                <button class="btn btn-ghost" onclick="hideConfirm()">Cancel</button>
                <button class="btn btn-primary" onclick="submitForm()">Yes, Send Now</button>
            </div>
        </div>
    </div>

    <script>
        const presets = {
            maintenance: `üõ† **SYSTEM MAINTENANCE**\n\nPlease be advised that the Fayda Bot will be undergoing scheduled maintenance shortly. Some services may be temporarily unavailable.\n\nWe will notify you once the system is fully restored. Thank you for your patience.\n---\nüõ† **·ã®·àµ·à≠·ãì·âµ ·å•·åà·äì**\n\n·ã®·çã·ã≠·ã≥ ·â¶·âµ ·â†·âÖ·à≠·â° ·ã®·â≥·âÄ·ã∞ ·å•·åà·äì ·ä•·äï·ã∞·àö·ã∞·à®·åç·â†·âµ ·àç·äì·à≥·ãç·âÖ·ãé ·ä•·äï·ãà·ã≥·àà·äï·ç¢ ·ä†·äï·ã≥·äï·ãµ ·ä†·åà·àç·åç·àé·â∂·âΩ ·àà·åä·ãú·ãç ·àã·ã≠·à∞·à© ·ã≠·âΩ·àã·àâ·ç¢\n\n·å•·åà·äì·ãç ·à≤·å†·äì·âÄ·âÖ ·ä•·äì ·àµ·à≠·ãì·â± ·ãà·ã∞ ·àò·ã∞·â†·äõ ·àµ·à´·ãç ·à≤·àò·àà·àµ ·ä•·äì·à≥·ãç·âÖ·ãé·â≥·àà·äï·ç¢ ·àà·âµ·ãï·åç·àµ·âµ·ãé ·ä•·äì·àò·à∞·åç·äì·àà·äï·ç¢`,
            restored: `‚ú® **SERVICE RESTORED**\n\nThe maintenance is now complete and all bot services have been fully restored. You can now resume your downloads and management as usual.\n\nThank you for choosing Fayda Bot!\n---\n‚ú® **·ä†·åà·àç·åç·àé·â± ·â∞·àò·àç·à∑·àç**\n\n·ã®·å•·åà·äì ·àµ·à´·ãç ·â∞·å†·äì·âÖ·âã·àç ·ä•·äì ·àÅ·àâ·àù ·ã®·â¶·âµ ·ä†·åà·àç·åç·àé·â∂·âΩ ·àô·àâ ·â†·àô·àâ ·àµ·à´ ·åÄ·àù·à®·ãã·àç·ç¢ ·ä•·äï·ã∞·ãà·âµ·àÆ·ãç ·àõ·ãç·à®·ãµ ·ä•·äì ·àò·å†·âÄ·àù ·ã≠·âΩ·àã·àâ·ç¢\n\n·çã·ã≠·ã≥ ·â¶·âµ·äï ·àµ·àà·àò·à®·å° ·ä•·äì·àò·à∞·åç·äì·àà·äï!`,
            newfeature: `üöÄ **EXCITING UPDATE**\n\nWe've added a new feature to Fayda Bot! [Describe feature here]. We're constantly working to improve your experience.\n\nTry it out now by sending /start!\n---\nüöÄ **·ä†·ã≤·àµ ·ãù·àò·äì**\n\n·â†·çã·ã≠·ã≥ ·â¶·âµ ·àã·ã≠ ·ä†·ã≤·àµ ·ä†·åà·àç·åç·àé·âµ ·å®·àù·à®·äì·àç! [·ãù·à≠·ãù·à©·äï ·ä•·ãö·àÖ ·ã≠·åç·àà·åπ]·ç¢ ·ã®·ä•·à≠·àµ·ãé·äï ·â∞·àû·ä≠·àÆ ·àà·àõ·àª·àª·àç ·àÅ·àç·åä·ãú ·ä•·ã®·à∞·à´·äï ·äê·ãç·ç¢\n\n·ä†·àÅ·äë·äë /start ·â†·àõ·àà·âµ ·ã≠·àû·ä≠·à©·âµ!`
        };

        function applyPreset(id) {
            const area = document.getElementById('message');
            if (id === 'clear') {
                area.value = '';
                return;
            }
            area.value = presets[id] || '';
        }

        function showConfirm() {
            const msg = document.getElementById('message').value.trim();
            if (!msg) {
                alert('Please enter a message first.');
                return;
            }
            document.getElementById('confirmModal').style.display = 'flex';
        }

        function hideConfirm() {
            document.getElementById('confirmModal').style.display = 'none';
        }

        function submitForm() {
            document.getElementById('announcementForm').submit();
        }
    </script>
</body>

</html>